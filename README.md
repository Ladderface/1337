# üì± ADB Device Manager ‚Äî –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ Android-—É—Å—Ç—Ä–æ–π—Å—Ç–≤

<details>
<summary>üìë –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ</summary>

- [–í–≤–µ–¥–µ–Ω–∏–µ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#–≤–≤–µ–¥–µ–Ω–∏–µ-–∏-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Ñ–∞–π–ª–æ–≤](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞-–∏-—Ñ–∞–π–ª–æ–≤)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä](#—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π-—Å–µ—Ä–≤–µ—Ä)
- [–ê–≥–µ–Ω—Ç](#–∞–≥–µ–Ω—Ç)
- [–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å](#–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-–æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å)
- [–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ: –ø–ª–∞–≥–∏–Ω—ã, –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)
- [UI/UX: –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü, —Ñ–∏–ª—å—Ç—Ä–æ–≤](#uiux)
- [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ best practices](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [FAQ](#faq)
- [Roadmap](#roadmap)
- [–°—Å—ã–ª–∫–∏](#—Å—Å—ã–ª–∫–∏)
- [–í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –≥—Ä–∞—Ñ–∏–∫–∏](#–∞–Ω–∞–ª–∏—Ç–∏–∫–∞)
- [–ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ –∏ –∞—Ä—Ö–∏–≤–∞—Ü–∏—è](#retention)
- [–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∏ –¥–µ–ø–ª–æ–π](#–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π-–∑–∞–ø—É—Å–∫-–∏-–¥–µ–ø–ª–æ–π)
- [–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤](#–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö-—Ç–µ—Å—Ç–æ–≤)
- [CI/CD](#ci-cd)
- [–†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞](#—Ä–æ–ª–µ–≤–∞—è-–º–æ–¥–µ–ª—å-–∏-–ø—Ä–∞–≤–∞-–¥–æ—Å—Ç—É–ø–∞)

</details>

---

# –í–≤–µ–¥–µ–Ω–∏–µ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ <a name="–≤–≤–µ–¥–µ–Ω–∏–µ-–∏-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞"></a>

**ADB Device Manager** ‚Äî —ç—Ç–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Android-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –∏ —ç–º—É–ª—è—Ç–æ—Ä–∞–º–∏ —á–µ—Ä–µ–∑ ADB. –û–Ω–∞ –≤–∫–ª—é—á–∞–µ—Ç:

- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (FastAPI + SQLite + Jinja2 UI)
- –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –∞–≥–µ–Ω—Ç–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä/—Ö–æ—Å—Ç —Å —ç–º—É–ª—è—Ç–æ—Ä–∞–º–∏)
- REST API –¥–ª—è –æ–±–º–µ–Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏, –ª–æ–≥–∞–º–∏, –∫–æ–º–∞–Ω–¥–∞–º–∏
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –∏—Å—Ç–æ—Ä–∏–∏, –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (Telegram, Google Sheets, Webhook, –Ω–µ–π—Ä–æ—Å–µ—Ç–∏ –∏ –¥—Ä.)
- –ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, —Ä–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å—Ö–µ–º–∞:**

```
[ Android-—ç–º—É–ª—è—Ç–æ—Ä—ã/—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ ]
         | (ADB)
      [ Agent (Python) ]  <--- config_agent.yaml
         | (REST API)
      [ –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (FastAPI) ]  <--- config.yaml
         | (Web UI, API, WebSocket)
      [ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å / –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ]
```

- –ö–∞–∂–¥—ã–π –∞–≥–µ–Ω—Ç —É–ø—Ä–∞–≤–ª—è–µ—Ç –≥—Ä—É–ø–ø–æ–π —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –Ω–∞ —Å–≤–æ—ë–º —Å–µ—Ä–≤–µ—Ä–µ, —Å–Ω–∏–º–∞–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—ã, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –Ω–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä.
- –°–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç —Å–∫—Ä–∏–Ω—ã –∏ –ª–æ–≥–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ data/ –∏ –±–∞–∑–µ, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é, –∏—Å—Ç–æ—Ä–∏—é, –º–∞—Å—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏.
- –í—Å—è –ª–æ–≥–∏–∫–∞ –º–æ–¥—É–ª—å–Ω–∞—è: –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã, —Å—Ü–µ–Ω–∞—Ä–∏–∏, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, UI-—Å—Ç—Ä–∞–Ω–∏—Ü—ã.

---

# –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç <a name="–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç"></a>

<details>
<summary>–ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è</summary>

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**

```bash
pip install -r requirements.txt
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥–∏:**

- `config.yaml` ‚Äî –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞
- `agent/config_agent.yaml` ‚Äî –¥–ª—è –∞–≥–µ–Ω—Ç–∞

3. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä:**

```bash
cd central_server
uvicorn server:app --reload --host 0.0.0.0 --port 8000
```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≥–µ–Ω—Ç–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —Å–µ—Ä–≤–µ—Ä–µ —Å —ç–º—É–ª—è—Ç–æ—Ä–∞–º–∏:**

```bash
cd agent
python agent.py
```

5. **–û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**

- <http://localhost:8000> ‚Äî –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, —Ñ–∏–ª—å—Ç—Ä—ã, –∏—Å—Ç–æ—Ä–∏—è
- <http://localhost:8000/logs> ‚Äî –ª–æ–≥–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è
- <http://localhost:8000/commands> ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥

</details>

---

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Ñ–∞–π–ª–æ–≤ <a name="—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞-–∏-—Ñ–∞–π–ª–æ–≤"></a>

<details>
<summary>–î–µ—Ä–µ–≤–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π (–æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã)</summary>

```
1337/
‚îú‚îÄ‚îÄ central_server/
‚îÇ   ‚îú‚îÄ‚îÄ server.py           # FastAPI —Å–µ—Ä–≤–µ—Ä, REST API, Web UI, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ templates/          # Jinja2-—à–∞–±–ª–æ–Ω—ã (index, logs, commands)
‚îÇ   ‚îú‚îÄ‚îÄ static/             # CSS, JS, –∏–∫–æ–Ω–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ data/               # –°–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (–ø–æ —Å–µ—Ä–≤–µ—Ä–∞–º/–æ–∫–Ω–∞–º)
‚îÇ   ‚îî‚îÄ‚îÄ db.sqlite3          # –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Å–∫—Ä–∏–Ω—ã, –ª–æ–≥–∏, –∫–æ–º–∞–Ω–¥—ã)
‚îú‚îÄ‚îÄ agent/
‚îÇ   ‚îú‚îÄ‚îÄ agent.py            # –ê–≥–µ–Ω—Ç: —Å–Ω–∏–º–∞–µ—Ç —Å–∫—Ä–∏–Ω—ã, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç, —Å–ª—É—à–∞–µ—Ç –∫–æ–º–∞–Ω–¥—ã
‚îÇ   ‚îî‚îÄ‚îÄ config_agent.yaml   # –ö–æ–Ω—Ñ–∏–≥ –∞–≥–µ–Ω—Ç–∞ (—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Å–µ—Ä–≤–µ—Ä, –∫–ª—é—á)
‚îú‚îÄ‚îÄ config.yaml             # –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ñ–∏–≥ —Å–µ—Ä–≤–µ—Ä–∞ (—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, —Å—Ü–µ–Ω–∞—Ä–∏–∏, API-–∫–ª—é—á–∏, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)
‚îú‚îÄ‚îÄ requirements.txt        # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îú‚îÄ‚îÄ devices.txt             # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
‚îú‚îÄ‚îÄ screenshots/            # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ª–æ–∫–∞–ª—å–Ω—ã–µ —Å–∫—Ä–∏–Ω—ã
‚îú‚îÄ‚îÄ logs/                   # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –ª–æ–≥–∏
‚îú‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îî‚îÄ‚îÄ ...
```

</details>

---

# –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è <a name="–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è"></a>

## config.yaml (—Å–µ—Ä–≤–µ—Ä)

```yaml
devices:
  - id: 127.0.0.1:5555
    enabled: true
    scenario: default
  - id: 127.0.0.1:5575
    enabled: true
    scenario: default
scenarios:
  default:
    steps:
      - action: click_image
        template: tpl1.png
        screenshot: true
        screenshot_section: "login"
        screenshot_dir: "screenshots/login"
        upload_to_db: false
      - action: input_text
        text: "Hello"
        screenshot: false
        upload_to_db: false
      - action: click_image
        template: tpl2.png
        screenshot: true
        screenshot_section: "main"
        screenshot_dir: "screenshots/main"
        upload_to_db: true
      - action: wait
        seconds: 10
        screenshot: false
        upload_to_db: false
api_keys:
  - testkey
telegram:
  bot_token: "<your_bot_token>"
  chat_id: "<your_chat_id>"
```

- **devices** ‚Äî —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (id = –∞–¥—Ä–µ—Å ADB)
- **scenarios** ‚Äî —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ (—à–∞–≥–∏, –¥–µ–π—Å—Ç–≤–∏—è, —É—Å–ª–æ–≤–∏—è)
- **api_keys** ‚Äî —Å–ø–∏—Å–æ–∫ –∫–ª—é—á–µ–π –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–≥–µ–Ω—Ç–æ–≤
- **telegram** ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram

## agent/config_agent.yaml (–∞–≥–µ–Ω—Ç)

```yaml
server_url: "http://localhost:8000"
api_key: "testkey"
server_id: "server-01"
devices:
  - id: "127.0.0.1:5555"
    enabled: true
    window: "main"
    interval: 60
screenshot_dir: screenshots
log_level: INFO
```

- **server_url** ‚Äî –∞–¥—Ä–µ—Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- **api_key** ‚Äî –∫–ª—é—á –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ config.yaml)
- **server_id** ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π id —Å–µ—Ä–≤–µ—Ä–∞/–∞–≥–µ–Ω—Ç–∞
- **devices** ‚Äî —Å–ø–∏—Å–æ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- **screenshot_dir** ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è –ø–∞–ø–∫–∞ –¥–ª—è —Å–∫—Ä–∏–Ω–æ–≤
- **log_level** ‚Äî —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

---

(–î–∞–ª—å–Ω–µ–π—à–∏–µ —Ä–∞–∑–¥–µ–ª—ã: —Å–µ—Ä–≤–µ—Ä, –∞–≥–µ–Ω—Ç, API, UI, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ, FAQ, Roadmap ‚Äî –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —á–∞—Å—Ç—è—Ö)

---

## –ú–æ–¥—É–ª–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ <a name="–º–æ–¥—É–ª–∏-–∏-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏"></a>

| –ú–æ–¥—É–ª—å         | –û–ø–∏—Å–∞–Ω–∏–µ                | –í–∫–ª—é—á–µ–Ω–∏–µ –≤ config.yaml | –°—Ç–∞—Ç—É—Å   |
|----------------|------------------------|------------------------|----------|
| Telegram       | –ê–ª–µ—Ä—Ç—ã –≤ Telegram      | `modules.telegram: true`| ‚úÖ       |
| Google Sheets  | –≠–∫—Å–ø–æ—Ä—Ç –≤ —Ç–∞–±–ª–∏—Ü—ã      | `modules.google_sheets: true` | ‚¨ú    |
| Webhook        | –í–Ω–µ—à–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è    | `modules.webhook: true`| ‚¨ú       |

<details>
<summary>–ü—Ä–∏–º–µ—Ä —Å–µ–∫—Ü–∏–∏ –¥–ª—è Telegram</summary>

```yaml
modules:
  telegram: true
telegram:
  bot_token: "<your_bot_token>"
  chat_id: "<your_chat_id>"
```

</details>

<details>
<summary>–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é</summary>

1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤ integrations/ (–Ω–∞–ø—Ä–∏–º–µ—Ä, webhook.py)
2. –û–ø–∏—à–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ config.yaml
3. –í server.py –¥–æ–±–∞–≤—å—Ç–µ –≤—ã–∑–æ–≤ –º–æ–¥—É–ª—è, –µ—Å–ª–∏ –æ–Ω –≤–∫–ª—é—á—ë–Ω
4. –ü—Ä–∏–º–µ—Ä –≤—ã–∑–æ–≤–∞:

   ```python
   if cfg['modules'].get('webhook'):
       from integrations.webhook import send_webhook
       send_webhook(...)
   ```

</details>

---

## –ú–∞—Å—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã <a name="–º–∞—Å—Å–æ–≤—ã–µ-–∫–æ–º–∞–Ω–¥—ã"></a>

<details>
<summary>–ü—Ä–∏–º–µ—Ä—ã –º–∞—Å—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥</summary>

- –î–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤:

  ```json
  { "server_id": "*", "command": "screencap" }
  ```

- –î–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞:

  ```json
  { "server_id": "server-01", "command": "screencap" }
  ```

- –î–ª—è –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞/—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞:

  ```json
  { "server_id": "server-01", "device_id": "127.0.0.1:5555", "command": "screencap" }
  ```

</details>

---

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∏ –ø–ª–∞–≥–∏–Ω—ã <a name="—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ-–∏-–ø–ª–∞–≥–∏–Ω—ã"></a>

<details>
<summary>–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø –∫–æ–º–∞–Ω–¥—ã</summary>

- –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–æ–º–∞–Ω–¥—ã –≤ agent.py (device_job)
- –ü—Ä–∏–º–µ—Ä:

  ```python
  elif cmd['command'] == 'reboot':
      # –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
  ```

</details>

<details>
<summary>–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç/—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é</summary>

- –î–æ–±–∞–≤—å—Ç–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç –≤ server.py
- –†–µ–∞–ª–∏–∑—É–π—Ç–µ —ç–∫—Å–ø–æ—Ä—Ç –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç (CSV, Excel, ZIP)
- –î–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (templates/)

</details>

<details>
<summary>–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å watchdog/–∞–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ</summary>

- –†–µ–∞–ª–∏–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫/–ø—Ä–æ—Ü–µ—Å—Å –≤ agent.py
- –í–∫–ª—é—á–∞–π—Ç–µ —á–µ—Ä–µ–∑ config_agent.yaml:

  ```yaml
  modules:
    watchdog: true
  ```

</details>

---

## –ö–æ–Ω—Ñ–∏–≥–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ <a name="–∫–æ–Ω—Ñ–∏–≥–∏-–∏-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-—Ñ—É–Ω–∫—Ü–∏—è–º–∏"></a>

<details>
<summary>–ü—Ä–∏–º–µ—Ä —Å–µ–∫—Ü–∏–∏ modules –≤ config.yaml</summary>

```yaml
modules:
  telegram: true
  google_sheets: false
  webhook: false
  mass_commands: true
  auto_cleanup: false
```

</details>

<details>
<summary>–ü—Ä–∏–º–µ—Ä —Å–µ–∫—Ü–∏–∏ modules –≤ config_agent.yaml</summary>

```yaml
modules:
  telegram_alerts: true
  plugins: true
```

</details>

---

## Roadmap <a name="roadmap"></a>

| –§—É–Ω–∫—Ü–∏—è/–ú–æ–¥—É–ª—å         | –°—Ç–∞—Ç—É—Å |
|------------------------|--------|
| Telegram-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è    | ‚úÖ     |
| Google Sheets          | ‚¨ú     |
| Webhook                | ‚¨ú     |
| –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è | ‚¨ú     |
| –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤/—Å–∫—Ä–∏–Ω–æ–≤  | ‚¨ú     |
| –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥         | ‚¨ú     |
| –ì—Ä–∞—Ñ–∏–∫–∏/–∞–Ω–∞–ª–∏—Ç–∏–∫–∞      | ‚¨ú     |
| –ú–∞—Å—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã       | ‚¨ú     |
| –ê—Ä—Ö–∏–≤–∞—Ü–∏—è/–∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ | ‚¨ú     |
| –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞  | ‚úÖ     |

---

## FAQ <a name="faq"></a>

---

<details>
<summary>–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ?</summary>

- –í config.yaml (—Å–µ—Ä–≤–µ—Ä) –∏–ª–∏ config_agent.yaml (–∞–≥–µ–Ω—Ç) –¥–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—É—é —Å–µ–∫—Ü–∏—é:

    ```yaml
    - id: "127.0.0.1:5595"
      enabled: true
      window: "main"
      interval: 60
    ```

- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≥–µ–Ω—Ç.

</details>

<details>
<summary>–ö–∞–∫ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –º–∞—Å—Å–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É?</summary>

- –ß–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å /commands –≤—ã–±–µ—Ä–∏—Ç–µ "–≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞" –∏–ª–∏ –Ω—É–∂–Ω—ã–π –¥–∏–∞–ø–∞–∑–æ–Ω.
- –ß–µ—Ä–µ–∑ API:

    ```json
    { "server_id": "*", "command": "screencap" }
    ```

</details>

<details>
<summary>–ö–∞–∫ –≤–∫–ª—é—á–∏—Ç—å Telegram-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è?</summary>

- –í config.yaml:

    ```yaml
    modules:
      telegram: true
    telegram:
      bot_token: "<your_bot_token>"
      chat_id: "<your_chat_id>"
    ```

- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä.

</details>

<details>
<summary>–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é?</summary>

- –°–º. —Ä–∞–∑–¥–µ–ª [–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ: –ø–ª–∞–≥–∏–Ω—ã, –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)

</details>

<details>
<summary>–ö–∞–∫ —Å–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø?</summary>

- –°–∫–æ–ø–∏—Ä—É–π—Ç–µ central_server/db.sqlite3 –∏ –ø–∞–ø–∫—É central_server/data/
- –î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ cron:

    ```bash
    tar czf backup_$(date +%F).tar.gz central_server/db.sqlite3 central_server/data/
    ```

</details>

<details>
<summary>–ö–∞–∫ –æ–±–Ω–æ–≤–∏—Ç—å —Å–∏—Å—Ç–µ–º—É?</summary>

- –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä/–∞–≥–µ–Ω—Ç–æ–≤
- –û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª—ã (git pull –∏–ª–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ)
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ requirements.txt –∏ –æ–±–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

    ```bash
    pip install -r requirements.txt
    ```

- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å—ã

</details>

<details>
<summary>–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø –∫–æ–º–∞–Ω–¥—ã?</summary>

- –í agent.py (device_job) –¥–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É:

    ```python
    elif cmd['command'] == 'reboot':
        subprocess.run(['adb', '-s', device_id, 'reboot'])
    ```

- –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É —á–µ—Ä–µ–∑ /commands –∏–ª–∏ API

</details>

<details>
<summary>–ö–∞–∫ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –≤–Ω–µ—à–Ω–µ–π —Å–∏—Å—Ç–µ–º–æ–π?</summary>

- –î–æ–±–∞–≤—å—Ç–µ –º–æ–¥—É–ª—å –≤ integrations/ (—Å–µ—Ä–≤–µ—Ä) –∏–ª–∏ plugins/ (–∞–≥–µ–Ω—Ç)
- –í—ã–∑–æ–≤–∏—Ç–µ –µ–≥–æ –∏–∑ server.py –∏–ª–∏ agent.py –ø–æ —Å–æ–±—ã—Ç–∏—é/—Ç–∞–π–º–µ—Ä—É

</details>

---

# Roadmap <a name="roadmap"></a>

| –§—É–Ω–∫—Ü–∏—è/–ú–æ–¥—É–ª—å         | –°—Ç–∞—Ç—É—Å |
|------------------------|--------|
| Telegram-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è    | ‚úÖ     |
| Google Sheets          | ‚¨ú     |
| Webhook                | ‚¨ú     |
| –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è | ‚¨ú     |
| –≠–∫—Å–ø–æ—Ä—Ç –ª–æ–≥–æ–≤/—Å–∫—Ä–∏–Ω–æ–≤  | ‚¨ú     |
| –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥         | ‚¨ú     |
| –ì—Ä–∞—Ñ–∏–∫–∏/–∞–Ω–∞–ª–∏—Ç–∏–∫–∞      | ‚¨ú     |
| –ú–∞—Å—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã       | ‚¨ú     |
| –ê—Ä—Ö–∏–≤–∞—Ü–∏—è/–∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ | ‚¨ú     |
| –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞  | ‚úÖ     |

---

# –°—Å—ã–ª–∫–∏ <a name="—Å—Å—ã–ª–∫–∏"></a>

- [CHANGELOG.md](CHANGELOG.md)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ FastAPI](https://fastapi.tiangolo.com/)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ ADB](https://developer.android.com/studio/command-line/adb)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ Telegram Bot API](https://core.telegram.org/bots/api)
- [Jinja2 Templates](https://jinja.palletsprojects.com/)
- [Chart.js (–≥—Ä–∞—Ñ–∏–∫–∏)](https://www.chartjs.org/)
- [Prometheus (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)](https://prometheus.io/)
- [Supervisor (–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫)](http://supervisord.org/)

---

> **‚ÑπÔ∏è –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏, –ø—Ä–∏–º–µ—Ä—ã –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã –¥–ª—è —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏. –î–ª—è –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ —Å–µ–∫—Ü–∏—é –≤ config.yaml –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏–∑ —ç—Ç–æ–≥–æ README!**

# –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –≥—Ä–∞—Ñ–∏–∫–∏ <a name="–∞–Ω–∞–ª–∏—Ç–∏–∫–∞"></a>

## /analytics ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

- –í–∫–ª–∞–¥–∫–∏: –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –û—à–∏–±–∫–∏/–∞–ª–µ—Ä—Ç—ã, –ö–æ–º–∞–Ω–¥—ã
- –ì—Ä–∞—Ñ–∏–∫–∏: Chart.js (–ª–∏–Ω–µ–π–Ω—ã–µ, —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ, –∫—Ä—É–≥–æ–≤—ã–µ)
- –§–∏–ª—å—Ç—Ä—ã: —Å–µ—Ä–≤–µ—Ä, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –¥–∞—Ç–∞ —Å/–ø–æ
- –î–∞–Ω–Ω—ã–µ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ API

### –ü—Ä–∏–º–µ—Ä—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤

- –°–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ –ª–æ–≥–∏ –ø–æ –¥–Ω—è–º (line)
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–æ–º–∞–Ω–¥ (doughnut)
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (bar)
- –û—à–∏–±–∫–∏/–∞–ª–µ—Ä—Ç—ã –ø–æ –¥–Ω—è–º (bar)
- –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥ –ø–æ –¥–Ω—è–º (line)

### API –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

- `/api/analytics/summary` ‚Äî —Å–∫—Ä–∏–Ω—à–æ—Ç—ã/–ª–æ–≥–∏ –ø–æ –¥–Ω—è–º, —Å—Ç–∞—Ç—É—Å—ã –∫–æ–º–∞–Ω–¥
- `/api/analytics/device_activity` ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- `/api/analytics/errors` ‚Äî –æ—à–∏–±–∫–∏/–∞–ª–µ—Ä—Ç—ã –ø–æ –¥–Ω—è–º
- `/api/analytics/commands_history` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥ –ø–æ –¥–Ω—è–º

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `server_id`, `device_id`, `date_from`, `date_to` (YYYY-MM-DD)

**–ü—Ä–∏–º–µ—Ä:**

```
GET /api/analytics/summary?server_id=server-01&date_from=2024-05-01&date_to=2024-05-31
```

**–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ (Chart.js):**

```json
{
  "screens_logs": {
    "data": { "labels": ["2024-05-01", ...], "datasets": [{"label": "–°–∫—Ä–∏–Ω—à–æ—Ç—ã", "data": [12, ...]}, ...] },
    "options": { ... }
  },
  "commands_status": { ... }
}
```

**UI:**

- –í–∫–ª–∞–¥–∫–∏, —Ñ–∏–ª—å—Ç—Ä—ã, –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å—Ç–∫–∞, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–æ–¥–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤

## –ê–Ω–∏–º–∞—Ü–∏—è, —Å—Ç–∞—Ç—É—Å—ã –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UX

- last.png –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã).
- –ö–∞—Ä—Ç–æ—á–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–∫—Ä–∏–Ω–∞ (–∞–Ω–∏–º–∞—Ü–∏—è).
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å: Online (—Å–∫—Ä–∏–Ω—à–æ—Ç —Å–≤–µ–∂–∏–π, <1 –º–∏–Ω) –∏–ª–∏ Offline (–Ω–µ—Ç –Ω–æ–≤—ã—Ö —Å–∫—Ä–∏–Ω–æ–≤).
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –∫–∞—Ä—Ç–æ—á–µ–∫, —Ü–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞.

# –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä <a name="—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π-—Å–µ—Ä–≤–µ—Ä"></a>

---

## 1. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä ‚Äî —ç—Ç–æ —è–¥—Ä–æ —Å–∏—Å—Ç–µ–º—ã. –û–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ –ª–æ–≥–∏ –æ—Ç –∞–≥–µ–Ω—Ç–æ–≤, —Ö—Ä–∞–Ω–∏—Ç –∏—Ö –≤ —Ñ–∞–π–ª–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST API –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏, –∏—Å—Ç–æ—Ä–∏–∏, –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π.

- **–Ø–∑—ã–∫:** Python 3.8+
- **–§—Ä–µ–π–º–≤–æ—Ä–∫:** FastAPI (ASGI)
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** SQLite (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –ª–µ–≥–∫–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ PostgreSQL/MySQL)
- **–®–∞–±–ª–æ–Ω—ã:** Jinja2 (HTML UI)
- **WebSocket:** –¥–ª—è live-–ª–æ–≥–æ–≤
- **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:** Telegram, Google Sheets, Webhook, –ø–ª–∞–≥–∏–Ω—ã
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:** API-–∫–ª—é—á–∏, —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## 2. –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

- `server.py` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä–Ω—ã–π —Å–∫—Ä–∏–ø—Ç (FastAPI)
- `templates/` ‚Äî HTML-—à–∞–±–ª–æ–Ω—ã (index, logs, commands)
- `static/` ‚Äî CSS, JS, –∏–∫–æ–Ω–∫–∏
- `data/` ‚Äî —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–æ –ø–æ —Å–µ—Ä–≤–µ—Ä–∞–º/–æ–∫–Ω–∞–º)
- `db.sqlite3` ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (—Å–∫—Ä–∏–Ω—ã, –ª–æ–≥–∏, –∫–æ–º–∞–Ω–¥—ã)

---

## 3. REST API: –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –∏ –ø—Ä–∏–º–µ—Ä—ã

### –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

–í—Å–µ API-–∑–∞–ø—Ä–æ—Å—ã (–∫—Ä–æ–º–µ /screenshots –∏ /download) —Ç—Ä–µ–±—É—é—Ç –∑–∞–≥–æ–ª–æ–≤–æ–∫:

```
Authorization: Bearer <api_key>
```

API-–∫–ª—é—á–∏ –∑–∞–¥–∞—é—Ç—Å—è –≤ `config.yaml`:

```yaml
api_keys:
  - testkey
  - anotherkey
```

### –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞

**POST /upload_screenshot**

- –§–æ—Ä–º—ã: `server_id`, `window`, `device_id`, `meta`, `image`
- –û—Ç–≤–µ—Ç: `{ "status": "ok", "path": "..." }`

**–ü—Ä–∏–º–µ—Ä –Ω–∞ Python:**

```python
import requests
url = 'http://localhost:8000/upload_screenshot'
headers = {'Authorization': 'Bearer testkey'}
data = {'server_id': 'server-01', 'window': 'main', 'device_id': '127.0.0.1:5555', 'meta': ''}
files = {'image': open('screen.png', 'rb')}
r = requests.post(url, headers=headers, data=data, files=files)
print(r.json())
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å–∫—Ä–∏–Ω–æ–≤

**GET /screenshots?server_id=...&window=...&device_id=...**

- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- –û—Ç–≤–µ—Ç: JSON-–º–∞—Å—Å–∏–≤ —Å–∫—Ä–∏–Ω–æ–≤

**–ü—Ä–∏–º–µ—Ä:**

```
GET /screenshots?server_id=server-01&window=main
```

### –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Å–∫—Ä–∏–Ω–∞

**GET /download/{server_id}/{window}/{filename}**

- –ü—Ä—è–º–∞—è —Å—Å—ã–ª–∫–∞ –Ω–∞ PNG-—Ñ–∞–π–ª

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è/–ª–æ–≥–∞

**POST /api/send_message**

- JSON: `{ server_id, device_id, type, message }`
- –û—Ç–≤–µ—Ç: `{ "status": "ok" }`

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π

**GET /api/messages?server_id=...&device_id=...&type=...&limit=100**

- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–µ—Ä–≤–µ—Ä—É, —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É, —Ç–∏–ø—É, –ª–∏–º–∏—Ç—É

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –¥–ª—è –∞–≥–µ–Ω—Ç–∞

**GET /api/get_commands?server_id=...&device_id=...**

- –û—Ç–≤–µ—Ç: `{ "commands": [ ... ] }`

### –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã

**POST /api/command_result**

- JSON: `{ command_id, status, result }`

### –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥

–°—Ç—Ä–∞–Ω–∏—Ü–∞ `/command_history` –∏ API `/api/command_history` –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å, —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –≤—Å–µ—Ö –∫–æ–º–∞–Ω–¥, –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –∞–≥–µ–Ω—Ç–∞–º.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**

- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–µ—Ä–≤–µ—Ä—É, —É—Å—Ç—Ä–æ–π—Å—Ç–≤—É, –∫–æ–º–∞–Ω–¥–µ, —Å—Ç–∞—Ç—É—Å—É, –¥–∞—Ç–µ, —Ç–µ–∫—Å—Ç—É/–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º
- –≠–∫—Å–ø–æ—Ä—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ CSV –∏ Excel (xlsx)
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- –ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –∫ –¥–µ—Ç–∞–ª—è–º –∫–æ–º–∞–Ω–¥

**–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: [http://localhost:8000/command_history](http://localhost:8000/command_history)
- API: `/api/command_history?server_id=...&device_id=...&format=csv`

**–ü–æ–ª—è:**

- `server_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞
- `device_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- `command` ‚Äî –∫–æ–º–∞–Ω–¥–∞
- `params` ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (JSON)
- `status` ‚Äî —Å—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (`pending`, `done`, `error` –∏ –¥—Ä.)
- `created_at` ‚Äî –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è

**–≠–∫—Å–ø–æ—Ä—Ç:**

- CSV: –∫–Ω–æ–ø–∫–∞ "–≠–∫—Å–ø–æ—Ä—Ç CSV" –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `format=csv`
- Excel: –∫–Ω–æ–ø–∫–∞ "–≠–∫—Å–ø–æ—Ä—Ç Excel" –∏–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä `format=xlsx`

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```
GET /api/command_history?server_id=server-01&status=done&format=xlsx
```

---

## 4. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (SQLite)

```sql
CREATE TABLE IF NOT EXISTS screenshots (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    server_id TEXT,
    window TEXT,
    device_id TEXT,
    filename TEXT,
    meta TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
CREATE TABLE IF NOT EXISTS messages (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    server_id TEXT,
    device_id TEXT,
    type TEXT,
    message TEXT,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
CREATE TABLE IF NOT EXISTS commands (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    server_id TEXT,
    device_id TEXT,
    command TEXT,
    params TEXT,
    status TEXT DEFAULT 'pending',
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

- **screenshots** ‚Äî –≤—Å–µ —Å–∫—Ä–∏–Ω—ã —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
- **messages** ‚Äî –ª–æ–≥–∏, –æ—à–∏–±–∫–∏, —Å—Ç–∞—Ç—É—Å—ã
- **commands** ‚Äî –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–≥–µ–Ω—Ç–æ–≤ (–∏ –∏—Ö —Å—Ç–∞—Ç—É—Å—ã)

---

## 5. –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Jinja2 + CSS)

- `/` ‚Äî –≥–ª–∞–≤–Ω–∞—è: –≥–∞–ª–µ—Ä–µ—è —Å–∫—Ä–∏–Ω–æ–≤, —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —Å–µ—Ä–≤–µ—Ä—É/—É—Å—Ç—Ä–æ–π—Å—Ç–≤—É/–æ–∫–Ω—É
- `/logs` ‚Äî –ª–æ–≥–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è, live-–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WebSocket
- `/commands` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–æ–º–∞–Ω–¥ –∞–≥–µ–Ω—Ç–∞–º (–≤—ã–±–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞, –∫–æ–º–∞–Ω–¥—ã, –ø–∞—Ä–∞–º–µ—Ç—Ä—ã)

### –ü—Ä–∏–º–µ—Ä —à–∞–±–ª–æ–Ω–∞ (index.html)

```html
<form class="filters" method="get">
    <input type="text" name="server_id" placeholder="–°–µ—Ä–≤–µ—Ä" value="{{ server_id or '' }}">
    <input type="text" name="window" placeholder="–û–∫–Ω–æ" value="{{ window or '' }}">
    <input type="text" name="device_id" placeholder="–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ" value="{{ device_id or '' }}">
    <button type="submit">–§–∏–ª—å—Ç—Ä</button>
    <a href="/" style="margin-left:12px;">–°–±—Ä–æ—Å–∏—Ç—å</a>
</form>
<div class="gallery">
    {% for s in screenshots %}
    <div class="gallery-item">
        <a href="/download/{{ s.server_id }}/{{ s.window }}/{{ s.filename }}" target="_blank">
            <img src="/download/{{ s.server_id }}/{{ s.window }}/{{ s.filename }}" class="gallery-img" alt="screenshot">
        </a>
        <div class="gallery-meta">
            <b>–°–µ—Ä–≤–µ—Ä:</b> {{ s.server_id }}<br>
            <b>–û–∫–Ω–æ:</b> {{ s.window }}<br>
            <b>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</b> {{ s.device_id }}<br>
            <b>–í—Ä–µ–º—è:</b> {{ s.created_at }}
        </div>
    </div>
    {% endfor %}
</div>
```

### –ü—Ä–∏–º–µ—Ä –∫–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏–∏ CSS (static/style.css)

```css
body { background: #f8f8fa; font-family: Arial, sans-serif; }
.container { max-width: 1200px; margin: 0 auto; padding: 24px; }
h1 { color: #2a2a6a; }
.filters { margin-bottom: 24px; }
.filters input, .filters select { padding: 6px 12px; border-radius: 6px; border: 1.5px solid #ccc; margin-right: 8px; }
.gallery { display: flex; flex-wrap: wrap; gap: 18px; }
.gallery-item { background: #fff; border-radius: 8px; box-shadow: 0 2px 8px #0001; padding: 10px; width: 240px; }
.gallery-img { width: 220px; max-height: 140px; border-radius: 6px; border: 1px solid #ccc; margin-bottom: 6px; }
.gallery-meta { font-size: 0.95em; color: #888; }
```

---

## 6. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

- **Telegram:** –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ –∞–ª–µ—Ä—Ç—ã –æ —Å–æ–±—ã—Ç–∏—è—Ö, –æ—à–∏–±–∫–∞—Ö, –º–∞—Å—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥–∞—Ö
- **Google Sheets:** —ç–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (TODO)
- **Webhook:** –≤–Ω–µ—à–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å CI/CD, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º
- **–ü–ª–∞–≥–∏–Ω—ã:** –ø—Ä–æ—Å—Ç–æ –¥–æ–±–∞–≤—å—Ç–µ —Ñ–∞–π–ª –≤ integrations/ –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –≤ server.py

**–ü—Ä–∏–º–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ Telegram:**

```python
def send_telegram_alert(text: str):
    import requests, yaml
    cfg = yaml.safe_load(open('../config.yaml', encoding='utf-8'))
    token = cfg['telegram']['bot_token']
    chat_id = cfg['telegram']['chat_id']
    url = f'https://api.telegram.org/bot{token}/sendMessage'
    requests.post(url, data={'chat_id': chat_id, 'text': text})
```

---

## 7. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

- –î–æ–±–∞–≤—å—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é/—ç–Ω–¥–ø–æ–∏–Ω—Ç –≤ `server.py` (FastAPI: @app.get, @app.post)
- –î–ª—è UI ‚Äî –¥–æ–±–∞–≤—å—Ç–µ —à–∞–±–ª–æ–Ω –≤ `templates/` –∏ —Ä–æ—É—Ç –≤ server.py
- –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ‚Äî —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤ `integrations/`, –ø–æ–¥–∫–ª—é—á–∏—Ç–µ —á–µ—Ä–µ–∑ config.yaml
- –î–ª—è –Ω–æ–≤—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤ ‚Äî —Ä–∞—Å—à–∏—Ä—å—Ç–µ SQL-–∑–∞–ø—Ä–æ—Å—ã –∏ —Ñ–æ—Ä–º—ã –≤ —à–∞–±–ª–æ–Ω–∞—Ö

**–ü—Ä–∏–º–µ—Ä: –¥–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç —Å–∫—Ä–∏–Ω–æ–≤ –≤ ZIP:**

```python
@app.get('/export_zip')
def export_zip(server_id: str):
    # –°–æ–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã, —É–ø–∞–∫–æ–≤–∞—Ç—å –≤ ZIP, –≤–µ—Ä–Ω—É—Ç—å FileResponse
    ...
```

---

## 8. –û—Ç–ª–∞–¥–∫–∞, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, best practices

- **–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ:**
  - FastAPI –ª–µ–≥–∫–æ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞—Ö (uvicorn --workers 4)
  - SQLite –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ PostgreSQL/MySQL –¥–ª—è –±–æ–ª—å—à–∏—Ö –æ–±—ä—ë–º–æ–≤
  - –•—Ä–∞–Ω–∏—Ç–µ —Å–∫—Ä–∏–Ω—ã –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω–æ–º –¥–∏—Å–∫–µ/NAS
- **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:**
  - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª–∏–Ω–Ω—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ API-–∫–ª—é—á–∏
  - –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ IP/Firewall
  - –í–∫–ª—é—á–∏—Ç–µ HTTPS (—á–µ—Ä–µ–∑ nginx/traefik)
- **–û—Ç–ª–∞–¥–∫–∞:**
  - –í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ messages
  - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /logs –¥–ª—è live-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
  - –î–ª—è —Ç–µ—Å—Ç–∞ API ‚Äî curl, Postman, httpie
- **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:**
  - –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î ‚Äî —á–µ—Ä–µ–∑ init_db() –≤ server.py
  - –î–ª—è –Ω–æ–≤—ã—Ö –≤–µ—Ä—Å–∏–π –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª—ã –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä

---

## 9. –ü—Ä–∏–º–µ—Ä—ã —Ç–∏–ø–æ–≤—ã—Ö –∑–∞–¥–∞—á

- **–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–∏–ø –∫–æ–º–∞–Ω–¥—ã:**
  - –í server.py ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ /api/get_commands –∏ /api/command_result
  - –í agent.py ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ device_job
- **–î–æ–±–∞–≤–∏—Ç—å –º–∞—Å—Å–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É:**
  - –í /commands (web UI) ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä "–≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞" –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä
- **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é:**
  - –í config.yaml ‚Äî —Å–µ–∫—Ü–∏—è modules
  - –í server.py ‚Äî –∏–º–ø–æ—Ä—Ç –∏ –≤—ã–∑–æ–≤ –º–æ–¥—É–ª—è
- **–î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç/–∞–Ω–∞–ª–∏—Ç–∏–∫—É:**
  - –ù–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç + —à–∞–±–ª–æ–Ω + SQL-–∑–∞–ø—Ä–æ—Å

---

(–°–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª: –ê–≥–µ–Ω—Ç ‚Äî –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∞–ª–µ–µ)

# –ê–≥–µ–Ω—Ç <a name="–∞–≥–µ–Ω—Ç"></a>

–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [docs/agent.md](docs/agent.md)

### –ó–∞–ø—É—Å–∫ –∏ CLI

- `python agent.py` ‚Äî –∑–∞–ø—É—Å–∫ –∞–≥–µ–Ω—Ç–∞
- `python agent.py status` ‚Äî —Å—Ç–∞—Ç—É—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –≤–µ—Ä—Å–∏—è ADB, uptime, —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ
- `python agent.py test` ‚Äî —Ç–µ—Å—Ç–æ–≤—ã–π —Ü–∏–∫–ª (—Å–∫—Ä–∏–Ω—à–æ—Ç, –æ—Ç–ø—Ä–∞–≤–∫–∞, –∫–æ–º–∞–Ω–¥—ã)

### –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ

- –° –∫–∞–∂–¥—ã–º —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–º –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è: –≤–µ—Ä—Å–∏—è ADB, uptime, —Å–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ

### Watchdog

- –§–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç ADB –ø—Ä–∏ —Å–±–æ—è—Ö

### –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞

- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞ update_agent —Å —Å–µ—Ä–≤–µ—Ä–∞ (–∑–∞–≥–ª—É—à–∫–∞, —Ç—Ä–µ–±—É–µ—Ç—Å—è URL)

### –¢–µ—Å—Ç—ã

- Unit: `python -m unittest discover -s agent/tests`

### –ú–∏–Ω–∏-–≥–∞–π–¥ –ø–æ –∑–∞–ø—É—Å–∫—É –∞–≥–µ–Ω—Ç–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

   ```bash
   pip install -r requirements.txt
   ```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ config_agent.yaml
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–≥–µ–Ω—Ç–∞:

   ```bash
   cd agent
   python agent.py
   ```

5. –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞:

   ```bash
   python agent.py status
   ```

6. –î–ª—è —Ç–µ—Å—Ç–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:

   ```bash
    curl -f http://localhost:8000/ || echo 'Server DOWN!' | mail -s 'ADB Server Alert' admin@example.com
    ```

---

## 5. Best practices

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ server_id –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞.
- –•—Ä–∞–Ω–∏—Ç–µ –≤—Å–µ –ª–æ–≥–∏ –∏ —Å–∫—Ä–∏–Ω—ã —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ, –¥–µ–ª–∞–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã.
- –î–ª—è production ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS, firewall, –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞.
- –î–ª—è –∫—Ä—É–ø–Ω—ã—Ö –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–π ‚Äî –≤—ã–Ω–æ—Å–∏—Ç–µ storage –∏ –ë–î –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã.
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–Ω—Ñ–∏–≥–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ.

---

(–°–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑–¥–µ–ª: –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ ‚Äî –ø–ª–∞–≥–∏–Ω—ã, –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ ‚Äî –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –¥–∞–ª–µ–µ)

# –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ: –ø–ª–∞–≥–∏–Ω—ã, –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ <a name="—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ"></a>

---

## 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–ª–∞—Å—å –∫–∞–∫ –º–æ–¥—É–ª—å–Ω–∞—è –∏ —Ä–∞—Å—à–∏—Ä—è–µ–º–∞—è:

- –õ—é–±–æ–π –º–æ–¥—É–ª—å (–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –∫–æ–º–∞–Ω–¥–∞, UI-—Å—Ç—Ä–∞–Ω–∏—Ü–∞) –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —è–¥—Ä–∞
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –≤–∫–ª—é—á–∞—é—Ç—Å—è/–≤—ã–∫–ª—é—á–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ config.yaml/config_agent.yaml
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –ø–ª–∞–≥–∏–Ω—ã, –≤–Ω–µ—à–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç—ã, –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã, –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

---

## 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è/–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (—Å–µ—Ä–≤–µ—Ä)

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –≤ `central_server/integrations/`**
    - –ü—Ä–∏–º–µ—Ä: `webhook.py`
2. **–û–ø–∏—à–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ config.yaml**

    ```yaml
    modules:
      webhook: true
    webhook:
      url: "https://your.webhook.url/endpoint"
      secret: "mysecretkey"
    ```

3. **–í server.py –¥–æ–±–∞–≤—å—Ç–µ –≤—ã–∑–æ–≤ –º–æ–¥—É–ª—è:**

    ```python
    if cfg['modules'].get('webhook'):
        from integrations.webhook import send_webhook
        send_webhook(...)
    ```

4. **–í—ã–∑–æ–≤–∏—Ç–µ –º–æ–¥—É–ª—å –∏–∑ –Ω—É–∂–Ω–æ–≥–æ –º–µ—Å—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Å–∫—Ä–∏–Ω–∞/–ª–æ–≥–∞/–∫–æ–º–∞–Ω–¥—ã)**

---

## 3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã (—Å–µ—Ä–≤–µ—Ä + –∞–≥–µ–Ω—Ç)

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ

- –í —Ç–∞–±–ª–∏—Ü—É `commands`

```

# –ê–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ –∏ –∞—Ä—Ö–∏–≤–∞—Ü–∏—è <a name="retention"></a>

## –û–ø–∏—Å–∞–Ω–∏–µ

- –§–æ–Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ –ª–æ–≥–∏ –ø–æ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ retention_days.
- –ü–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –º–æ–∂–Ω–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ (ZIP).
- –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –≤ config.yaml (—Å–µ–∫—Ü–∏—è global).

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã
- `retention_days`: —Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π —Ö—Ä–∞–Ω–∏—Ç—å —Å–∫—Ä–∏–Ω—ã –∏ –ª–æ–≥–∏ (0 = –Ω–µ —É–¥–∞–ª—è—Ç—å)
- `cleanup_interval_hours`: –∫–∞–∫ —á–∞—Å—Ç–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ—á–∏—Å—Ç–∫—É (–≤ —á–∞—Å–∞—Ö)
- `archive_old`: –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å –ø–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º (true/false)
- `archive_dir`: –ø–∞–ø–∫–∞ –¥–ª—è –∞—Ä—Ö–∏–≤–æ–≤

## –ü—Ä–∏–º–µ—Ä config.yaml
```yaml
global:
  retention_days: 30
  cleanup_interval_hours: 12
  archive_old: true
  archive_dir: archives
```

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Ñ–æ–Ω–æ–≤—ã–π –ø–æ—Ç–æ–∫ –æ—á–∏—Å—Ç–∫–∏.
- –í—Å–µ —Å–∫—Ä–∏–Ω—ã –∏ –ª–æ–≥–∏ —Å—Ç–∞—Ä—à–µ retention_days –∞—Ä—Ö–∏–≤–∏—Ä—É—é—Ç—Å—è (–µ—Å–ª–∏ archive_old=true) –∏ —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã –∏ –ë–î.
- –ê—Ä—Ö–∏–≤—ã —Å–∫–ª–∞–¥—ã–≤–∞—é—Ç—Å—è –≤ archive_dir (ZIP –¥–ª—è —Å–∫—Ä–∏–Ω–æ–≤, logs.csv.zip –¥–ª—è –ª–æ–≥–æ–≤).

## Best practices

- –î–ª—è production: –Ω–µ —Å—Ç–∞–≤—å—Ç–µ retention_days=0 (–∏–Ω–∞—á–µ –¥–∏—Å–∫ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–ø–æ–ª–Ω–∏—Ç—å—Å—è)
- –î–ª—è –±–æ–ª—å—à–∏—Ö –∞—Ä—Ö–∏–≤–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–π –¥–∏—Å–∫/—Ä–∞–∑–¥–µ–ª –¥–ª—è archive_dir
- –î–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ –∞—Ä—Ö–∏–≤–æ–≤

## –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ (last.png)

- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞/–æ–∫–Ω–∞ —Å–µ—Ä–≤–µ—Ä —Ö—Ä–∞–Ω–∏—Ç last.png (–ø–æ—Å–ª–µ–¥–Ω–∏–π –∞–∫—Ç—É–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–Ω—à–æ—Ç).
- –ë—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ API:
  - `GET /download_last/{server_id}/{window}/{device_id}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å last.png
- –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Ç–µ–ø–µ—Ä—å –æ—Ç–¥–µ–ª—å–Ω–∞—è —Å–µ–∫—Ü–∏—è "–ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã (last.png)" –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.

## API

- `POST /upload_screenshot` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞, —Ç–µ–ø–µ—Ä—å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏ last.png
- `GET /download_last/{server_id}/{window}/{device_id}` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–∫—Ä–∏–Ω—à–æ—Ç (last.png)
- `GET /download/{server_id}/{window}/{filename}` ‚Äî —Å–∫–∞—á–∞—Ç—å –ª—é–±–æ–π —Å–∫—Ä–∏–Ω—à–æ—Ç –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏

## Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞: –±—ã—Å—Ç—Ä—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä last.png –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤/–æ–∫–æ–Ω, –ø–µ—Ä–µ—Ö–æ–¥ –∫ –∏—Å—Ç–æ—Ä–∏–∏, —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ.
- –ò—Å—Ç–æ—Ä–∏—è –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º, –æ–∫–Ω–∞–º, –≤—Ä–µ–º–µ–Ω–∏, –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º.

## –°–µ–∫—Ü–∏–∏ (sections) –∏ –±–∏–Ω–¥—ã (binds)

- –í—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –æ–∫–Ω–∞ —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ —Å–µ–∫—Ü–∏—è–º (–Ω–∞–ø—Ä–∏–º–µ—Ä, "login", "main", "settings").
- –°–µ–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ window –∏–ª–∏ –ø–æ meta.section (–µ—Å–ª–∏ meta —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ section).
- –ù–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ last.png —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —Å–µ–∫—Ü–∏—è–º.
- –í —Ñ–∏–ª—å—Ç—Ä–∞—Ö –∏ API –º–æ–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å section –¥–ª—è –±—ã—Å—Ç—Ä–æ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.
- –ü—Ä–∏–º–µ—Ä API:
  - `GET /screenshots?section=main` ‚Äî –≤—Å–µ —Å–∫—Ä–∏–Ω—ã –∏–∑ —Å–µ–∫—Ü–∏–∏ main
  - `GET /?section=login` ‚Äî web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: —Ç–æ–ª—å–∫–æ —Å–µ–∫—Ü–∏—è login

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏: webhook, Google Sheets, Telegram

- –í—Å–µ —Å–æ–±—ã—Ç–∏—è (—Å–∫—Ä–∏–Ω—à–æ—Ç, –ª–æ–≥, –∫–æ–º–∞–Ω–¥–∞) –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤–æ –≤–Ω–µ—à–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã, –µ—Å–ª–∏ –º–æ–¥—É–ª—å –≤–∫–ª—é—á—ë–Ω –≤ config.yaml.
- –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è:
  - Webhook (Slack, Discord, SIEM –∏ –¥—Ä.)
  - Google Sheets (–∑–∞–ø–∏—Å—å —Å–æ–±—ã—Ç–∏–π –≤ —Ç–∞–±–ª–∏—Ü—É)
  - Telegram (–∞–ª–µ—Ä—Ç—ã –ø–æ error/alert)
- –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–µ–∫—Ü–∏—é modules:

```yaml
modules:
  webhook: true
  google_sheets: true
  telegram: true
```

- –ü—Ä–∏–º–µ—Ä —Å–µ–∫—Ü–∏–∏ webhook:

```yaml
webhook:
  url: "https://your.webhook.url/endpoint"
  secret: "mysecretkey"
```

- –ü—Ä–∏–º–µ—Ä —Å–µ–∫—Ü–∏–∏ google_sheets:

```yaml
google_sheets:
  credentials: "central_server/integrations/credentials.json"
  sheet_id: "1AbC...xyz"
  worksheet: "–õ–∏—Å—Ç1"
```

- –ü—Ä–∏–º–µ—Ä —Å–µ–∫—Ü–∏–∏ telegram:

```yaml
telegram:
  bot_token: "<your_bot_token>"
  chat_id: "<your_chat_id>"
```

- –í—Å–µ —Å–æ–±—ã—Ç–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Ö—É–∫:
  - `screenshot_uploaded` ‚Äî –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å–∫—Ä–∏–Ω–∞
  - `log`, `error`, `alert` ‚Äî –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è/–ª–æ–≥–∞
  - `command_result` ‚Äî –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∏ –¥–µ–ø–ª–æ–π <a name="–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π-–∑–∞–ø—É—Å–∫-–∏-–¥–µ–ø–ª–æ–π"></a>

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏ –¥–µ–ø–ª–æ—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã:

- Linux/macOS: `run_full_stack.sh`, `run_server_only.sh`, `run_agent_only.sh`
- Windows: `run_everything_win.bat`, `run_server_only_win.bat`, `run_agent_only_win.bat`
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∞–≤—Ç–æ—Å–∫—Ä–∏–ø—Ç: `python run_check_and_setup.py`

–í—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–æ–≤—è—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –ø—Ä–æ–≤–µ—Ä—è—Ç –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∑–∞–ø—É—Å—Ç—è—Ç –Ω—É–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã. –ü–æ–¥—Ä–æ–±–Ω–µ–µ ‚Äî —Å–º. —Ä–∞–∑–¥–µ–ª "README.md" –≤—ã—à–µ.

# –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ <a name="–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö-—Ç–µ—Å—Ç–æ–≤"></a>

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –≤—Å–µ–π —Å–∏—Å—Ç–µ–º—ã –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç:

```bash
python run_integration_tests.py
```

–°–∫—Ä–∏–ø—Ç:

- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ –∞–¥—Ä–µ—Å—É <http://127.0.0.1:8000/>
- –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–µ –∑–∞–ø—É—â–µ–Ω ‚Äî –≤—ã–≤–æ–¥–∏—Ç –æ—à–∏–±–∫—É –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ø–æ –∑–∞–ø—É—Å–∫—É
- –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã (agent/tests/test_device_session.py)
- –í —Ç–µ—Å—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω—ã–π HTTP webhook endpoint (<http://127.0.0.1:9999/webhook>), –∏ —Ç–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä —Ä–µ–∞–ª—å–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST-–∑–∞–ø—Ä–æ—Å –Ω–∞ —ç—Ç–æ—Ç endpoint (—Ä–µ–∞–ª—å–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è, –∞ –Ω–µ mock).
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ç–µ—Å—Ç–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞ –∏–ª–∏ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º!**

# –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å <a name="–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ-–∏-–æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å"></a>

–°–∏—Å—Ç–µ–º–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –¥–µ—Å—è—Ç–∫–∏ —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏ —Å–æ—Ç–Ω–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ö–æ—Å—Ç–∞, —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä, —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥. –ü–æ–¥—Ä–æ–±–Ω–µ–µ:

- [8. –û—Ç–ª–∞–¥–∫–∞, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, best practices](#8-–æ—Ç–ª–∞–¥–∫–∞-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ-best-practices)
- [Best practices](#best-practices)

# –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ best practices <a name="–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å"></a>

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ API-–∫–ª—é—á–∏, firewall, HTTPS, —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã. –î–ª—è production ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –ø–æ IP. –ü–æ–¥—Ä–æ–±–Ω–µ–µ:

- [Best practices](#best-practices)
- [8. –û—Ç–ª–∞–¥–∫–∞, –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ, best practices](#8-–æ—Ç–ª–∞–¥–∫–∞-–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ-best-practices)

# –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –≥—Ä–∞—Ñ–∏–∫–∏ <a name="–∞–Ω–∞–ª–∏—Ç–∏–∫–∞"></a>

## /analytics ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

- –í–∫–ª–∞–¥–∫–∏: –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –û—à–∏–±–∫–∏/–∞–ª–µ—Ä—Ç—ã, –ö–æ–º–∞–Ω–¥—ã
- –ì—Ä–∞—Ñ–∏–∫–∏: Chart.js (–ª–∏–Ω–µ–π–Ω—ã–µ, —Å—Ç–æ–ª–±—á–∞—Ç—ã–µ, –∫—Ä—É–≥–æ–≤—ã–µ)
- –§–∏–ª—å—Ç—Ä—ã: —Å–µ—Ä–≤–µ—Ä, —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ, –¥–∞—Ç–∞ —Å/–ø–æ
- –î–∞–Ω–Ω—ã–µ –ø–æ–¥–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ API

### –ü—Ä–∏–º–µ—Ä—ã –≥—Ä–∞—Ñ–∏–∫–æ–≤

- –°–∫—Ä–∏–Ω—à–æ—Ç—ã –∏ –ª–æ–≥–∏ –ø–æ –¥–Ω—è–º (line)
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–æ–º–∞–Ω–¥ (doughnut)
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤ (bar)
- –û—à–∏–±–∫–∏/–∞–ª–µ—Ä—Ç—ã –ø–æ –¥–Ω—è–º (bar)
- –ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥ –ø–æ –¥–Ω—è–º (line)

### API –¥–ª—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏

- `/api/analytics/summary` ‚Äî —Å–∫—Ä–∏–Ω—à–æ—Ç—ã/–ª–æ–≥–∏ –ø–æ –¥–Ω—è–º, —Å—Ç–∞—Ç—É—Å—ã –∫–æ–º–∞–Ω–¥
- `/api/analytics/device_activity` ‚Äî –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- `/api/analytics/errors` ‚Äî –æ—à–∏–±–∫–∏/–∞–ª–µ—Ä—Ç—ã –ø–æ –¥–Ω—è–º
- `/api/analytics/commands_history` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥ –ø–æ –¥–Ω—è–º

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `server_id`, `device_id`, `date_from`, `date_to` (YYYY-MM-DD)

**–ü—Ä–∏–º–µ—Ä:**

```
GET /api/analytics/summary?server_id=server-01&date_from=2024-05-01&date_to=2024-05-31
```

**–§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞ (Chart.js):**

```json
{
  "screens_logs": {
    "data": { "labels": ["2024-05-01", ...], "datasets": [{"label": "–°–∫—Ä–∏–Ω—à–æ—Ç—ã", "data": [12, ...]}, ...] },
    "options": { ... }
  },
  "commands_status": { ... }
}
```

**UI:**

- –í–∫–ª–∞–¥–∫–∏, —Ñ–∏–ª—å—Ç—Ä—ã, –∞–¥–∞–ø—Ç–∏–≤–Ω–∞—è –≤–µ—Ä—Å—Ç–∫–∞, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –ø–æ–¥–≥—Ä—É–∑–∫–∞ –≥—Ä–∞—Ñ–∏–∫–æ–≤

## –ê–Ω–∏–º–∞—Ü–∏—è, —Å—Ç–∞—Ç—É—Å—ã –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π UX

- last.png –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥ (–±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã).
- –ö–∞—Ä—Ç–æ—á–∫–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–∫—Ä–∏–Ω–∞ (–∞–Ω–∏–º–∞—Ü–∏—è).
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å: Online (—Å–∫—Ä–∏–Ω—à–æ—Ç —Å–≤–µ–∂–∏–π, <1 –º–∏–Ω) –∏–ª–∏ Offline (–Ω–µ—Ç –Ω–æ–≤—ã—Ö —Å–∫—Ä–∏–Ω–æ–≤).
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω –∫–∞—Ä—Ç–æ—á–µ–∫, —Ü–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞.

# CI/CD

![CI](https://github.com/<YOUR_GITHUB_USERNAME>/<YOUR_REPO>/actions/workflows/ci.yml/badge.svg)

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∫–æ–º–º–∏—Ç–µ –∏ pull request —á–µ—Ä–µ–∑ GitHub Actions:

- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- –ó–∞–ø—É—Å–∫ `python run_integration_tests.py`
- –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ ‚Äî –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ª–æ–≥–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ Actions

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤:**

- –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç—ã –≤ `agent/tests/`
- –í—Å–µ —Ç–µ—Å—Ç—ã –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ CI
- –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞: `python run_integration_tests.py`

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã

- –ó–∞–ø—É—Å–∫: `python -m unittest agent/tests/test_device_session.py`
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Ä–µ–∞–ª—å–Ω—ã–π –≤—ã–∑–æ–≤ webhook (POST), Google Sheets –∏ Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ (–º–æ–∫).
- config.yaml –¥–ª—è —Ç–µ—Å—Ç–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –Ω–∏—á–µ–≥–æ –º–µ–Ω—è—Ç—å –Ω–µ –Ω—É–∂–Ω–æ.
- –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –±–µ–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–ª—é—á–µ–π –∏ —Ñ–∞–π–ª–æ–≤ (Google Sheets –∏ Telegram ‚Äî mock, webhook ‚Äî —Ä–µ–∞–ª—å–Ω—ã–π HTTP).

### –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã config.yaml –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

```yaml
modules:
  webhook: true
  google_sheets: true
  telegram: true
webhook:
  url: http://127.0.0.1:PORT/webhook
  secret: test
google_sheets:
  credentials: fake.json
  sheet_id: fakeid
  worksheet: –õ–∏—Å—Ç1
telegram:
  bot_token: fake
  chat_id: fake
```

## CI/CD

- –í—Å–µ —Ç–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è –≤ GitHub Actions (—Å–º. .github/workflows/ci.yml).
- –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö —Ç–µ—Å—Ç–æ–≤ –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è server.log –∏ –ø–æ–¥—Ä–æ–±–Ω—ã–π –≤—ã–≤–æ–¥.

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ç–µ—Å—Ç–æ–≤

```sh
pip install -r requirements.txt
python -m unittest agent/tests/test_device_session.py
```

## üß™ –ò–∑–æ–ª—è—Ü–∏—è config.yaml –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ CI

–î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏ race condition –ø—Ä–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º –∑–∞–ø—É—Å–∫–µ —Ç–µ—Å—Ç–æ–≤ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `CONFIG_YAML`. –ï—Å–ª–∏ –æ–Ω–∞ –∑–∞–¥–∞–Ω–∞, —Å–µ—Ä–≤–µ—Ä –∏ –≤—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —É–∫–∞–∑–∞–Ω–Ω—ã–π –ø—É—Ç—å –∫ config.yaml.

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º config.yaml:**

```bash
# Linux/Mac:
CONFIG_YAML=/tmp/test_config.yaml uvicorn central_server.server:app --host 127.0.0.1 --port 8000
```

```bat
:: Windows (cmd):
set CONFIG_YAML=C:\Users\dimas\Documents\1337\test_config.yaml
uvicorn central_server.server:app --host 127.0.0.1 --port 8000
```

```powershell
# Windows (PowerShell):
$env:CONFIG_YAML="C:\Users\dimas\Documents\1337\test_config.yaml"
uvicorn central_server.server:app --host 127.0.0.1 --port 8000
```

## üß™ Google Sheets e2e —Ç–µ—Å—Ç

–î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ e2e —Ç–µ—Å—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Google Sheets (–±–µ–∑ mock) –∑–∞–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

- `GSHEET_CREDENTIALS` ‚Äî –ø—É—Ç—å –∫ credentials.json (Google Service Account)
- `GSHEET_SHEET_ID` ‚Äî ID Google Sheet
- `GSHEET_WORKSHEET` ‚Äî –∏–º—è –ª–∏—Å—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é "–õ–∏—Å—Ç1")

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Windows (cmd):**

```bat
set GSHEET_CREDENTIALS=C:\Users\dimas\Documents\1337\credentials.json
set GSHEET_SHEET_ID=1AbC...xyz
set GSHEET_WORKSHEET=–õ–∏—Å—Ç1
python -m unittest agent/tests/test_device_session.py
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Linux/Mac:**

```bash
export GSHEET_CREDENTIALS=/home/user/credentials.json
export GSHEET_SHEET_ID=1AbC...xyz
export GSHEET_WORKSHEET=–õ–∏—Å—Ç1
python -m unittest agent/tests/test_device_session.py
```

–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –∑–∞–¥–∞–Ω—ã –∏–ª–∏ —Ñ–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî —Ç–µ—Å—Ç –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω (mock).

## üß™ Telegram e2e —Ç–µ—Å—Ç

–î–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ e2e —Ç–µ—Å—Ç–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å Telegram (–±–µ–∑ mock) –∑–∞–¥–∞–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

- `TG_BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞
- `TG_CHAT_ID` ‚Äî chat_id –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Windows (cmd):**

```bat
set TG_BOT_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11
set TG_CHAT_ID=123456789
python -m unittest agent/tests/test_device_session.py
```

**–ü—Ä–∏–º–µ—Ä –¥–ª—è Linux/Mac:**

```bash
export TG_BOT_TOKEN=123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11
export TG_CHAT_ID=123456789
python -m unittest agent/tests/test_device_session.py
```

–ï—Å–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –∑–∞–¥–∞–Ω—ã ‚Äî —Ç–µ—Å—Ç –±—É–¥–µ—Ç –ø—Ä–æ–ø—É—â–µ–Ω (mock).

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞

- –≠–∫—Å–ø–æ—Ä—Ç —Å–∫—Ä–∏–Ω–æ–≤ –≤ CSV —Ç–µ–ø–µ—Ä—å —Å—Ç–∞–±–∏–ª–µ–Ω, ValueError –∏–∑-–∑–∞ –ª–∏—à–Ω–∏—Ö –ø–æ–ª–µ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 'section') —É—Å—Ç—Ä–∞–Ω—ë–Ω (v0.2.1).
- –¢–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç –Ω–∞ Windows, PermissionError –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ db.sqlite3 —É—Å—Ç—Ä–∞–Ω—ë–Ω (tearDownClass –¥–µ–ª–∞–µ—Ç retry).

## –†–æ–ª–µ–≤–∞—è –º–æ–¥–µ–ª—å –∏ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

- **admin** ‚Äî –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø (—ç–∫—Å–ø–æ—Ä—Ç, –∫–æ–º–∞–Ω–¥—ã, –ª–æ–≥–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä)
- **user** ‚Äî –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –∏ –ª–æ–≥–∏, –Ω–µ –º–æ–∂–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å
- **readonly** ‚Äî —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä, –Ω–µ –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–∞–Ω–¥—ã/–ª–æ–≥–∏/—ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å

–ü—Ä–∏–º–µ—Ä —Å–µ–∫—Ü–∏–∏ users –¥–ª—è config.yaml:

```yaml
users:
  - username: admin
    api_key: testkey
    role: admin
  - username: user1
    api_key: userkey
    role: user
  - username: guest
    api_key: guestkey
    role: readonly
```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–æ–ª–µ–π:**

- –í—Å–µ REST API –∏ UI –∑–∞—â–∏—â–µ–Ω—ã –ø–æ —Ä–æ–ª—è–º
- –ü–æ–∫—Ä—ã—Ç–∏–µ –∞–≤—Ç–æ—Ç–µ—Å—Ç–∞–º–∏: –ø—Ä–∞–≤–∞ –Ω–∞ —ç–∫—Å–ø–æ—Ä—Ç, –∫–æ–º–∞–Ω–¥—ã, –ª–æ–≥–∏, –ø—Ä–æ—Å–º–æ—Ç—Ä
- –î–ª—è —Ç–µ—Å—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª—é—á–∏ testkey (admin), userkey (user), guestkey (readonly)
